extends layout

block content
  .row
    div(class="col-md-9 col-sm-12 col-xs-12 main-container")
      ul(class="flex-container")
        article(class="flex-item col-md-12")
          .article_container
            h4(class="col-md-12 post_category2")= post.category
            h2.main-titles= post.title
            ul(class="list-inline col-md-12 subhead2")
              li
                ul(class="list-inline")
                  li
                    img(src="/img/comment.png") 
                  li
                    span(class="disqus-comment-count", data-disqus-url="http://localhost:8000/post/" + post.title + "#disqus_thread") 0 Comments

                    script.
                      var disqus_shortname = 'annappablogtest';

                      (function () {
                        var s = document.createElement('script'); s.async = true;
                        s.type = 'text/javascript';
                        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                      }());


              li
                ul(class="list-inline")
                  li
                    img(src="/img/clock.png") 
                  li
                    p= post.date
              li
                ul(class="list-inline")
                  li
                    img(src="/img/author.png") 
                  li= post.author_name

            //.post-social-icons2
                  ul(class="list-inline")
                    li
                      a(class="twitter-share-button", href="https://twitter.com/intent/tweet?text=Check%20this%20out- " + post.title, data-size="default")
                    li
                      div(class="g-plusone",data-href="https://www.google.co.in", data-annotation="bubble",data-size="medium", style="width:70px; overflow:hidden; top:-1px;")
                    li
                      div(class="fb-share-button", data-href="https://www.google.co.in", data-layout="button_count", style="width:auto; overflow:hidden; top:-1px;")

            .social-container
                  div(class="t-soc")
                    a(href="https://twitter.com/intent/tweet?url=http%3A%2F%2Fcodelikeninja.ml%2Fpost" + "&hashtags=" + "," + "&text=Check%20this%20out- " + post.title + "&via=codelikeninja")
                      .s-pic
                    div(class="social-count" id="twitter"+i data-count="0", href="https://twitter.com/intent/tweet?text=Check%20this%20out- " + post.title, target="_blank") 0 
                  div(class="f-soc")
                    a(href="https://www.facebook.com/sharer/sharer.php?u=http://stackoverflow.com/", target="_blank")
                      .s-pic
                    div(class="social-count" id="facebook"+i data-count="0") 0
                  div(class="p-soc")
                    a(href="https://plus.google.com/share?url=http://stackoverflow.com/", target="_blank")
                      .s-pic
                    div(class="social-count" id="pinterest"+i data-count="0") 0

                  
            script.
              // Format Number functions
              function abbreviateNumber(value) {
                  var newValue = value;
                  if (value >= 1000) {
                      var suffixes = ["", "k", "m", "b","t"];
                      var suffixNum = Math.floor( (""+value).length/3 );
                      var shortValue = '';
                      for (var precision = 2; precision >= 1; precision--) {
                          shortValue = parseFloat( (suffixNum != 0 ? (value / Math.pow(1000,suffixNum) ) : value).toPrecision(precision));
                          var dotLessShortValue = (shortValue + '').replace(/[^a-zA-Z 0-9]+/g,'');
                          if (dotLessShortValue.length <= 2) { break; }
                      }
                      if (shortValue % 1 != 0)  shortNum = shortValue.toFixed(1);
                      newValue = shortValue+suffixes[suffixNum];
                  }
                  return newValue;
              }

              function facebookShares($URL) {

                $.getJSON('http://graph.facebook.com/?callback=?&id=' + $URL, function (fbdata) {
                  //console.log("FACEBOOK : " + JSON.stringify(fbdata));
                  //$(".social-count").html("hsk");
                  $('#facebook'+#{i}).text(abbreviateNumber(fbdata.shares));
                  //$('#facebook'+#{i}).attr('data-count', fbdata.shares)
                });

              }

              function pinShares($URL) {
                var pin = 'http://api.pinterest.com/v1/urls/count.json?callback=?';
                $.getJSON(pin, {
                    url: $URL,
                }).done(function (data) {
                    $('#pinterest'+#{i}).text(abbreviateNumber(data.count));
                });
              }

              // Twitter Shares Count
              function twitterShares($URL) {

                  $.getJSON('http://cdn.api.twitter.com/1/urls/count.json?url=' + $URL + '&callback=?', function (twitdata) {
                      console.log("TWITTER : " + twitdata.count);
                      $('#twitter'+#{i}).text(abbreviateNumber(twitdata.count));
                      //$('#twitter'+#{i}).attr('data-count', twitdata.count)
                  });

              }


              function totalShares($URL) {
                  pinShares($URL);
                  twitterShares($URL);
                  facebookShares($URL);
                  //checkJSON_getSum();
              }

              totalShares("http://www.google.com");


            br
            h4(class="col-md-12",style="color:#666;") Tagged with :
            .tag-body.tags.col-md-12
              - for(var j=0 ; j< post.tags.length ; j++) {
                li
                  a(href="/tags/" + post.tags[j] + "/1", class="tag2")= post.tags[j]
              - };             
            
             script.
              function putPostBody(){
                var dom_target = document.getElementById("thePostBody");
                dom_target.innerHTML = !{post.body};
              }

            .post-body.col-md-12
              .pic2.col-md-12
                img(src="/img/posts_full/default/960x540.jpg")
              .post-content.col-md-12
                div(id="thePostBody", class="editor_article")
                  div(class="editor_article") !{post.body}

                script.
                  //putPostBody();
        
        article(class="flex-item col-md-12 col-sm-12 col-xs-12")                 
          h3.main-titles You might also like
          - if(similar_posts.length == 0){
              article(class="flex-item col-md-2 col-sm-5 col-xs-5 grid-element2")
                h6(class="post-title") Sorry no articles found
          - }
          - for(var i=0 ; i< similar_posts.length ; i++) {
              article(class="flex-item col-md-2 col-sm-5 col-xs-5 grid-element2")
                a(class="col-md-12 post-title-link" href="/post/"+ similar_posts[i].title)
                  h6(class="post-title")= similar_posts[i].title
                .post-body.col-md-12
                  .pic
                    img(src="/img/posts_short/default/300x150.jpg")
                  
                ul(class="list-inline subhead col-md-12")
                  li
                    ul(class="list-inline")
                      li
                        img(src="/img/comment.png") 
                      li
                        span(class="disqus-comment-count", data-disqus-url="http://localhost:8000/post/" + similar_posts[i].title + "#disqus_thread") 0 Comments

                        script.
                          var disqus_shortname = 'annappablogtest';

                          (function () {
                            var s = document.createElement('script'); s.async = true;
                            s.type = 'text/javascript';
                            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
                            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
                          }());
          - };                

        article(class="flex-item col-md-12 col-sm-12 col-xs-12")
          div(class="disqus", id="disqus_thread")    

    include ./widgets